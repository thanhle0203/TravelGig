$(document).ready(function() {
    $("#searchBtn").click(function(){
        var searchText = $("#searchLocation").val();
        $('#tblHotel tr').not(':first').remove();
        $.get("http://localhost:8383/searchHotel/"+ searchText, {}, function(responseText) {
            $.each(responseText, function(key1, value1) {
                var row = "<tr><td>" + value1.hotelName + "</td><td><img class='hotelImage' src='" + value1.imageURL + "' width='300' height='300'/></td><td>" + value1.averagePrice + "</td><td>" + value1.starRating + "</td> </tr>";
                $("#tblHotel").append(row);
            });
        });
    });
    
    $("#tblHotel").on('click','.hotelImage', function() {
        var hotelName = $(this).parent().siblings(":first").text();
        var searchText = $("#searchLocation").val();
        $.get("http://localhost:8383/searchHotel/" + searchText, function(responseText) {
            var hotelRoomTypes = responseText[0].hotelRooms;
            
            $.each(responseText, function(key1, value1) {
                if (value1.hotelName === hotelName) {
                    hotelRoomTypes = value1.roomTypes;
                    return false;
                }
            });
            $("#myModal").modal();
            $("#modal_hotelName").val(hotelName);
            $("#modal_noGuests").val($("#noGuests").val());
            $("#modal_CheckInDate").val($("#checkInDate").val());
            $("#modal_CheckOutDate").val($("#checkOutDate").val());
            $("#modal_noRooms").val($("#noRooms").val());
            $("#select_roomTypes").empty();
            $.each(hotelRoomTypes, function(key, value) {
                $("#select_roomTypes").append($("<option>").val(value.type.name).text(value.type.name));
            });
        });
    });
});
